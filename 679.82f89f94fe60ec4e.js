"use strict";(self.webpackChunkair_bnb=self.webpackChunkair_bnb||[]).push([[679],{2679:(L,h,r)=>{r.r(h),r.d(h,{ProfilePageModule:()=>q});var c=r(9808),f=r(1156),e=r(5e3),I=r(8976),T=r(9727),k=r(6094),U=r(520);let z=(()=>{class n{constructor(t){this.https=t,this.Variable=new k._}getListTickets(){return this.https.get(this.Variable.BaseUrl+"api/tickets",{headers:Object.assign({},this.Variable.Headers)})}getInfoTicket(t){return this.https.get(this.Variable.BaseUrl+"api/tickets/"+t,{headers:Object.assign({},this.Variable.Headers)})}updateInfoTicket(t,o,i,l,d,u){return this.https.put(this.Variable.BaseUrl+"api/tickets/"+t,{checkIn:o,checkOut:i,userId:l,roomId:d},{headers:Object.assign(Object.assign({},this.Variable.Headers),{token:u})})}deleteTickets(t,o){return this.https.delete(this.Variable.BaseUrl+"api/tickets/"+t,{headers:Object.assign(Object.assign({},this.Variable.Headers),{token:o})})}createNewTicket(t,o,i,l,d){return this.https.post(this.Variable.BaseUrl+"api/tickets",{checkIn:t,checkOut:o,userId:i,roomId:l},{headers:Object.assign(Object.assign({},this.Variable.Headers),{token:d})})}getListTicketsByUserId(t){return this.https.post(this.Variable.BaseUrl+"api/tickets/by-user?userId="+t,{headers:Object.assign({},this.Variable.Headers)})}getListTicketsByRoomId(t){return this.https.post(this.Variable.BaseUrl+"api/tickets/by-room?roomId="+t,{headers:Object.assign({},this.Variable.Headers)})}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(U.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var v=r(2683),Z=r(3087),s=r(3075),p=r(4546),b=r(1894),C=r(1047),_=r(3868),y=r(6042),S=r(2643);function A(n,a){1&n&&(e.ynx(0),e._uU(1,"Please input your phone number!"),e.BQk())}function x(n,a){1&n&&(e.ynx(0),e._uU(1," Phone number is invalid! "),e.BQk())}function E(n,a){if(1&n&&(e.YNc(0,A,2,0,"ng-container",31),e.YNc(1,x,2,0,"ng-container",31)),2&n){const t=a.$implicit;e.Q6J("ngIf",t.hasError("required")),e.xp6(1),e.Q6J("ngIf",t.hasError("pattern"))}}let F=(()=>{class n{constructor(t,o){this.fb=t,this.userService=o,this.userInfo={},this.openUpdateBtn=!0,this.isVisible=!1,this.localStorageService=new f.D}changeOpenUpdateBtn(){return this.openUpdateBtn=!1}ngOnInit(){this.validateForm=this.fb.group({phone:[this.userInfo.phone,[s.kI.required,s.kI.pattern("^[0-9-+]{9,15}$")]],birthday:[this.userInfo.birthday.split("T")[0],[s.kI.required]],address:[this.userInfo.address,[s.kI.required]],gender:[this.userInfo.gender],type:["CLIENT"],name:[this.userInfo.name,[s.kI.required]],email:[this.userInfo.email]})}showModal(){this.isVisible=!0}handleOk(){console.log("Button ok clicked!"),this.isVisible=!1}handleCancel(){console.log("Button cancel clicked!"),this.isVisible=!1}submitForm(){if(this.validateForm.valid){let{name:t,email:o,phone:i,birthday:l,gender:d,address:u,type:m}=this.validateForm.value;console.log("dataSend",{name:t,email:o,phone:i,birthday:l,gender:d,address:u,type:m}),this.userService.updateUserInfo(this.userInfo._id,t,this.userInfo.email,i,l,d,m,u,this.userInfo.token).subscribe(g=>{console.log("result",g),console.log("token",this.userInfo.token),this.localStorageService.setUserInfo(Object.assign({token:this.userInfo.token},g))},g=>{alert(g.error.message)})}else Object.values(this.validateForm.controls).forEach(t=>{t.invalid&&(t.markAsDirty(),t.updateValueAndValidity({onlySelf:!0}))})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(s.qu),e.Y36(I.K))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-update-info-form"]],inputs:{userInfo:"userInfo"},decls:49,vars:28,consts:[["data-toggle","modal","data-target","#update-user-info",1,"font-weight-bold","user__avatar--button","border-0","bg-gradient-light","cursor-pointer","mt-3"],["id","update-user-info","tabindex","-1","role","dialog","aria-labelledby","exampleModalLabel","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],["id","exampleModalLabel",1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["nz-form","","v","",1,"py-5",3,"formGroup","ngSubmit"],[1,"position-relative"],["nzFor","name","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please input your name!",3,"nzSm","nzXs"],["formControlName","name","id","name","type","text","nz-input","",3,"ngModelChange"],["nzFor","phoneNumber","nzRequired","",3,"nzSm","nzXs"],[3,"nzSm","nzXs","nzValidateStatus","nzErrorTip"],["formControlName","phone","id","'phoneNumber'","nz-input","",3,"ngModelChange"],["errorTpl2",""],["nzFor","birthday","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please input your birthday!",3,"nzSm","nzXs"],["formControlName","birthday","id","birthday","type","date","nz-input","",3,"ngModelChange"],["nzFor","address","nzRequired","",3,"nzSm","nzXs"],["nzErrorTip","Please input your address!",3,"nzSm","nzXs"],["formControlName","address","id","address","type","text","nz-input","",3,"ngModelChange"],["nzFor","gender","nzRequired","",3,"nzSm","nzXs"],[3,"nzSm","nzXs"],["formControlName","gender",3,"ngModelChange"],["nz-radio","",3,"nzValue"],["nz-row","",1,"register-area"],[3,"nzSpan","nzOffset"],["nz-button","","nzType","primary",3,"disabled"],[4,"ngIf"]],template:function(t,o){if(1&t&&(e.TgZ(0,"button",0)(1,"u"),e._uU(2,"Ch\u1ec9nh s\u1eeda h\u1ed3 s\u01a1"),e.qZA()(),e.TgZ(3,"div",1)(4,"div",2)(5,"div",3)(6,"div",4)(7,"h5",5),e._uU(8,"Update Info"),e.qZA(),e.TgZ(9,"button",6)(10,"span",7),e._uU(11,"\xd7"),e.qZA()()(),e.TgZ(12,"div",8)(13,"form",9),e.NdJ("ngSubmit",function(){return o.submitForm()}),e.TgZ(14,"nz-form-item",10)(15,"nz-form-label",11),e._uU(16,"Name"),e.qZA(),e.TgZ(17,"nz-form-control",12)(18,"input",13),e.NdJ("ngModelChange",function(){return o.changeOpenUpdateBtn()}),e.qZA()()(),e.TgZ(19,"nz-form-item")(20,"nz-form-label",14),e._uU(21,"Phone "),e.qZA(),e.TgZ(22,"nz-form-control",15)(23,"input",16),e.NdJ("ngModelChange",function(){return o.changeOpenUpdateBtn()}),e.qZA(),e.YNc(24,E,2,2,"ng-template",null,17,e.W1O),e.qZA()(),e.TgZ(26,"nz-form-item",10)(27,"nz-form-label",18),e._uU(28,"Birthday"),e.qZA(),e.TgZ(29,"nz-form-control",19)(30,"input",20),e.NdJ("ngModelChange",function(){return o.changeOpenUpdateBtn()}),e.qZA()()(),e.TgZ(31,"nz-form-item",10)(32,"nz-form-label",21),e._uU(33,"Address"),e.qZA(),e.TgZ(34,"nz-form-control",22)(35,"input",23),e.NdJ("ngModelChange",function(){return o.changeOpenUpdateBtn()}),e.qZA()()(),e.TgZ(36,"nz-form-item")(37,"nz-form-label",24),e._uU(38,"Gender"),e.qZA(),e.TgZ(39,"nz-form-control",25)(40,"nz-radio-group",26),e.NdJ("ngModelChange",function(){return o.changeOpenUpdateBtn()}),e.TgZ(41,"label",27),e._uU(42,"Male"),e.qZA(),e.TgZ(43,"label",27),e._uU(44,"Female"),e.qZA()()()(),e.TgZ(45,"nz-form-item",28)(46,"nz-form-control",29)(47,"button",30),e._uU(48," Update "),e.qZA()()()()()()()()),2&t){const i=e.MAs(25);e.xp6(13),e.Q6J("formGroup",o.validateForm),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24),e.xp6(3),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24)("nzValidateStatus",o.validateForm.controls.phoneNumber)("nzErrorTip",i),e.xp6(5),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24),e.xp6(3),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24),e.xp6(3),e.Q6J("nzSm",6)("nzXs",24),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24),e.xp6(2),e.Q6J("nzValue",!0),e.xp6(2),e.Q6J("nzValue",!1),e.xp6(3),e.Q6J("nzSpan",14)("nzOffset",10),e.xp6(1),e.Q6J("disabled",o.openUpdateBtn)}},directives:[s._Y,s.JL,p.Lr,s.sg,b.SK,p.Nx,b.t3,p.iK,p.Fd,s.Fj,C.Zp,s.JJ,s.u,c.O5,_.Dg,_.Of,y.ix,S.dQ,v.w],encapsulation:2}),n})();function O(n,a){if(1&n&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div",3),e._UZ(3,"img",4),e.TgZ(4,"div",5)(5,"span"),e._uU(6),e.ALo(7,"date"),e.qZA(),e._uU(8," - "),e.TgZ(9,"span"),e._uU(10),e.ALo(11,"date"),e.qZA()()(),e.TgZ(12,"div",6)(13,"h3",7),e._uU(14),e.qZA(),e.TgZ(15,"div"),e._uU(16),e.ALo(17,"slice"),e.qZA()()()()),2&n){const t=e.oxw();e.xp6(3),e.s9C("src",t.dataInfoticket.roomId.image,e.LSH),e.s9C("alt",t.dataInfoticket.roomId.name),e.xp6(3),e.hij(" ",e.xi3(7,6,t.dataInfoticket.checkIn,"shortDate")," "),e.xp6(4),e.hij(" ",e.xi3(11,9,t.dataInfoticket.checkOut,"shortDate")," "),e.xp6(4),e.hij(" ",t.dataInfoticket.roomId.name," "),e.xp6(2),e.hij(" ",t.dataInfoticket.roomId.description.length>30?e.Dn7(17,12,t.dataInfoticket.roomId.description,0,30)+"...":t.dataInfoticket.roomId.description," ")}}let J=(()=>{class n{constructor(t){this.ticketService=t,this.dataInfoticket={}}ngOnInit(){this.ticketService.getInfoTicket(this.ticketId).subscribe(t=>{this.dataInfoticket=t,console.log(t)},t=>console.log(t))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(z))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-ticket-card"]],inputs:{ticketId:"ticketId"},decls:1,vars:1,consts:[["class","ticket-card py-2 border-bottom",4,"ngIf"],[1,"ticket-card","py-2","border-bottom"],[1,"row","p-3"],[1,"col-12","col-md-6","col-lg-4","ticket-card__img"],[1,"w-100","rounded",3,"src","alt"],[1,"ticket-card__date","text-center","mt-1"],[1,"col-12","col-md-6","col-lg-8"],[1,"h5"]],template:function(t,o){1&t&&e.YNc(0,O,18,16,"div",0),2&t&&e.Q6J("ngIf",o.dataInfoticket.roomId)},directives:[c.O5],pipes:[c.uU,c.OU],styles:[""]}),n})();function P(n,a){if(1&n&&e._UZ(0,"img",22),2&n){const t=e.oxw();e.s9C("src",t.userInfo.avatar,e.LSH)}}function N(n,a){1&n&&e._UZ(0,"div",23)}function B(n,a){if(1&n&&(e.TgZ(0,"div",24),e._UZ(1,"app-ticket-card",25),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Q6J("ticketId",t)}}let V=(()=>{class n{constructor(t,o,i){this.userService=t,this.msg=o,this.ticketService=i,this.userInfo={},this.fileToUpload=null,this.dataOfTickets={},this.fileName="",this.localStorage=new f.D}getInfoOfTicket(t){return this.ticketService.getInfoTicket(t).subscribe(o=>console.log(o),o=>console.log(o)),!0}ngOnInit(){this.userInfo=this.localStorage.getUserInfo(),console.log(this.userInfo.tickets),this.userInfo.tickets.forEach(t=>{console.log(t)})}onFileSelected(t){const o=t.target.files[0];o&&(this.fileName=o.name,(new FormData).append("avatar",o),console.log("upthanh cong",o),this.userService.updateAvataUser(o,this.userInfo.token).subscribe(l=>{console.log("result",l),this.localStorage.deleteUserInfo(),this.localStorage.setUserInfo(Object.assign({token:this.userInfo.token},l)),this.userInfo=this.localStorage.getUserInfo(),alert("Cap nhat thanh cong")},l=>{alert("Cap nhat khong thanh cong")}))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(I.K),e.Y36(T.dD),e.Y36(z))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-profile-page"]],decls:36,vars:6,consts:[[1,"container"],[1,"row","py-5"],[1,"col-12","col-md-4","border","px-4","py-3","rounded"],[1,"user__avatar","d-flex","flex-column","align-items-center"],["alt","","class","rounded-circle user__avatar--img ","style","width: 80px; height: 80px",3,"src",4,"ngIf"],["class","rounded-circle user__avatar--img  bg-secondary","style","width: 80px; height: 80px",4,"ngIf"],[1,"font-weight-bold","w-100","user__avatar--button","border-0","bg-gradient-light","cursor-pointer","mt-3",3,"click"],["type","file",1,"d-none",3,"change"],["fileUpload",""],[1,"user__authentication","mt-5","d-flex","flex-column","align-items-center"],["nz-icon","","nzType","check","nzTheme","outline"],[1,"btn","btn-light","border","border-secondary","mt-4"],[1,"w-100","border-top","mt-3","pt-4"],[1,"mb-2"],[1,"font-weight-normal"],[1,"col-12","col-md-8"],[1,"h3"],[3,"userInfo"],[1,"border-bottom","p-1","mt-3"],[1,"h3","mt-3"],[1,"user__tickets"],["class","user__ticket",4,"ngFor","ngForOf"],["alt","",1,"rounded-circle","user__avatar--img",2,"width","80px","height","80px",3,"src"],[1,"rounded-circle","user__avatar--img","bg-secondary",2,"width","80px","height","80px"],[1,"user__ticket"],[3,"ticketId"]],template:function(t,o){if(1&t){const i=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),e.YNc(4,P,1,1,"img",4),e.YNc(5,N,1,0,"div",5),e.TgZ(6,"button",6),e.NdJ("click",function(){return e.CHM(i),e.MAs(10).click()}),e.TgZ(7,"u"),e._uU(8," C\u1eadp nh\u1eadt \u1ea3nh "),e.qZA(),e.TgZ(9,"input",7,8),e.NdJ("change",function(d){return o.onFileSelected(d)}),e.qZA()()(),e.TgZ(11,"div",9),e._UZ(12,"i",10),e.TgZ(13,"span")(14,"strong"),e._uU(15," X\xe1c minh danh t\xednh "),e.qZA()(),e.TgZ(16,"span"),e._uU(17," X\xe1c th\u1ef1c danh t\xednh c\u1ee7a b\u1ea1n v\u1edbi huy hi\u1ec7u x\xe1c minh danh t\xednh"),e.qZA(),e.TgZ(18,"button",11),e._uU(19," Nh\u1eadn huy hi\u1ec7u "),e.qZA(),e.TgZ(20,"div",12)(21,"div",13)(22,"strong"),e._uU(23),e.qZA()(),e.TgZ(24,"div",14),e._UZ(25,"i",10),e._uU(26," \u0110\u1ecba ch\u1ec9 mail "),e.qZA()()()(),e.TgZ(27,"div",15)(28,"h3",16),e._uU(29),e.qZA(),e._UZ(30,"app-update-info-form",17)(31,"div",18),e.TgZ(32,"h3",19),e._uU(33,"Danh s\xe1ch v\xe9 c\u1ee7a b\u1ea1n"),e.qZA(),e.TgZ(34,"div",20),e.YNc(35,B,2,1,"div",21),e.qZA()()()()}2&t&&(e.xp6(4),e.Q6J("ngIf",o.userInfo.avatar),e.xp6(1),e.Q6J("ngIf",!o.userInfo.avatar),e.xp6(18),e.hij(" ",o.userInfo.email," \u0110\xe3 x\xe1c nh\u1eadn: "),e.xp6(6),e.hij("Xin ch\xe0o t\xf4i t\xean l\xe0 ",o.userInfo.name,""),e.xp6(1),e.Q6J("userInfo",o.userInfo),e.xp6(5),e.Q6J("ngForOf",o.userInfo.tickets))},directives:[c.O5,v.w,Z.Ls,F,c.sg,J],styles:[""]}),n})();var X=r(9436),M=r(8500),Q=r(4521);let j=[{path:"",component:r(9838).w,children:[{path:"",component:V}]}],q=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[c.ez,X.G,Q.Bz.forChild(j),s.u5,M.V,s.UX]]}),n})()}}]);